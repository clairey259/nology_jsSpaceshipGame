"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = stringifyValidator;
exports.isValueType = isValueType;

function stringifyValidator(validator, nodePrefix) {
  if (validator === undefined) {
    return "any";
  }

  if (validator.each) {
    return "Array<".concat(stringifyValidator(validator.each, nodePrefix), ">");
  }

  if (validator.chainOf) {
    var ret = stringifyValidator(validator.chainOf[1], nodePrefix);
    return Array.isArray(ret) && ret.length === 1 && ret[0] === "any" ? stringifyValidator(validator.chainOf[0], nodePrefix) : ret;
  }

  if (validator.oneOf) {
    return validator.oneOf.map(JSON.stringify).join(" | ");
  }

  if (validator.oneOfNodeTypes) {
    return validator.oneOfNodeTypes.map(function (_) {
      return nodePrefix + _;
    }).join(" | ");
  }

  if (validator.oneOfNodeOrValueTypes) {
    return validator.oneOfNodeOrValueTypes.map(function (_) {
      return isValueType(_) ? _ : nodePrefix + _;
    }).join(" | ");
  }

  if (validator.type) {
    return validator.type;
  }

  if (validator.shapeOf) {
    return "{ " + Object.keys(validator.shapeOf).map(function (shapeKey) {
      var propertyDefinition = validator.shapeOf[shapeKey];

      if (propertyDefinition.validate) {
        var isOptional = propertyDefinition.optional || propertyDefinition["default"] != null;
        return shapeKey + (isOptional ? "?: " : ": ") + stringifyValidator(propertyDefinition.validate);
      }

      return null;
    }).filter(Boolean).join(", ") + " }";
  }

  return ["any"];
}
/**
 * Heuristic to decide whether or not the given type is a value type (eg. "null")
 * or a Node type (eg. "Expression").
 */


function isValueType(type) {
  return type.charAt(0).toLowerCase() === type.charAt(0);
}